import{a as ee}from"./chunk-EYWMD56D.js";import{d as V,f as A}from"./chunk-AQGG5LPX.js";import{a as N,b as C,c as R,d as j,e as G,g as L,h as q,i as te,j as ne,k as ie,m as z,n as H}from"./chunk-D2BLZIV3.js";import{$a as T,Ab as $,Bb as w,Gb as X,Ha as u,Ka as m,M as K,Ma as F,Na as _,Oa as D,Pa as B,Qa as n,R as Q,Ra as i,Sa as f,Ta as P,Ua as c,Va as d,W as b,Wa as o,Xa as S,Ya as O,_a as h,ab as I,ca as x,da as v,ea as E,fa as y,ka as Z,wa as l,xa as g,zb as W}from"./chunk-SV6CTXGA.js";function de(t,s){if(t&1){let e=P();n(0,"div",1)(1,"div",2)(2,"h3"),o(3,"Ban User"),i(),n(4,"p",3),o(5),i(),n(6,"form",4),c("ngSubmit",function(){x(e);let a=d();return v(a.onSubmit())}),n(7,"div",5)(8,"label",6),o(9,"Ban Reason"),i(),n(10,"textarea",7),o(11,"        "),i()(),n(12,"div",5)(13,"label",8),o(14,"Ban Duration"),i(),n(15,"select",9)(16,"option",10),o(17,"1 day"),i(),n(18,"option",11),o(19,"1 week"),i(),n(20,"option",12),o(21,"1 month"),i(),n(22,"option",13),o(23,"3 months"),i(),n(24,"option",14),o(25,"6 months"),i(),n(26,"option",15),o(27,"1 year"),i(),n(28,"option",16),o(29,"Permanent"),i()()(),n(30,"div",17)(31,"button",18),c("click",function(){x(e);let a=d();return v(a.onCancel())}),o(32,"Cancel"),i(),n(33,"button",19),o(34,"Confirm Ban"),i()()()()()}if(t&2){let e=d();l(5),S(e.userEmail),l(),m("formGroup",e.banForm),l(27),m("disabled",e.banForm.invalid)}}var Y=(()=>{class t{constructor(e){this.fb=e,this.isOpen=!1,this.userEmail="",this.close=new Z,this.confirm=new Z,this.banForm=this.fb.group({reason:["",[C.required,C.minLength(10)]],duration:["7",C.required]})}onSubmit(){if(this.banForm.valid){let{reason:e,duration:r}=this.banForm.value;this.confirm.emit({reason:e,duration:Number(r)}),this.banForm.reset({duration:"7"})}}onCancel(){this.close.emit(),this.banForm.reset({duration:"7"})}static{this.\u0275fac=function(r){return new(r||t)(g(z))}}static{this.\u0275cmp=b({type:t,selectors:[["ban-dialog"]],inputs:{isOpen:"isOpen",userEmail:"userEmail"},outputs:{close:"close",confirm:"confirm"},standalone:!0,features:[h],decls:1,vars:1,consts:[["class","dialog-overlay",4,"ngIf"],[1,"dialog-overlay"],[1,"dialog-content"],[1,"user-email"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","reason"],["id","reason","formControlName","reason","placeholder","Enter the reason for banning this user","rows","3"],["for","duration"],["id","duration","formControlName","duration"],["value","1"],["value","7"],["value","30"],["value","90"],["value","180"],["value","365"],["value","-1"],[1,"button-group"],["type","button",1,"cancel-button",3,"click"],["type","submit",3,"disabled"]],template:function(r,a){r&1&&u(0,de,35,3,"div",0),r&2&&m("ngIf",a.isOpen)},dependencies:[w,W,H,G,ne,ie,N,te,R,j,L,q],styles:[".dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.dialog-content[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:8px;width:90%;max-width:500px;box-shadow:0 4px 6px #0000001a}h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:#e74c3c}.user-email[_ngcontent-%COMP%]{color:#666;margin-bottom:1.5rem;font-style:italic}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#333}textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #ddd;border-radius:4px;font-family:inherit}textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{outline:none;border-color:#e74c3c;box-shadow:0 0 0 2px #e74c3c33}.button-group[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end}button[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:4px;cursor:pointer;font-weight:500}button[type=submit][_ngcontent-%COMP%]{background:#e74c3c;color:#fff}.cancel-button[_ngcontent-%COMP%]{background:#eee;color:#333}button[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}"]})}}return t})();var M=(()=>{class t{constructor(e){this.http=e,this.apiUrl="http://localhost:8080"}getUserProfile(){return this.http.get(`${this.apiUrl}/profile`)}updateProfile(e){return this.http.put(`${this.apiUrl}/profile`,e)}changePassword(e){return this.http.put(`${this.apiUrl}/profile/password`,e)}resetPark(){return this.http.post(`${this.apiUrl}/profile/reset-park`,{})}getUsers(){return this.http.get(`${this.apiUrl}/users`)}changeUserRole(e,r){return this.http.put(`${this.apiUrl}/users/${e}/role`,{role:r})}deleteUser(e){return this.http.delete(`${this.apiUrl}/users/${e}`)}banUser(e,r){return this.http.post(`${this.apiUrl}/users/${e}/ban`,r)}unbanUser(e){return this.http.post(`${this.apiUrl}/users/${e}/unban`,{})}static{this.\u0275fac=function(r){return new(r||t)(Q(X))}}static{this.\u0275prov=K({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var ce=(t,s)=>s.id;function pe(t,s){if(t&1&&(o(0),T(1,"date")),t&2){let e=d(2).$implicit;O(" until ",I(1,1,e.banInfo==null?null:e.banInfo.bannedUntil)," ")}}function ue(t,s){t&1&&o(0," permanently ")}function fe(t,s){if(t&1&&(n(0,"span",11),o(1," Banned "),u(2,pe,2,3)(3,ue,1,0),i()),t&2){let e=d().$implicit;l(2),_(e.banInfo!=null&&e.banInfo.bannedUntil?2:3)}}function ge(t,s){t&1&&(n(0,"span",12),o(1,"Active"),i())}function _e(t,s){if(t&1){let e=P();n(0,"button",14),c("click",function(){x(e);let a=d().$implicit,p=d();return v(p.openBanDialog(a))}),o(1),i(),n(2,"button",15),c("click",function(){x(e);let a=d().$implicit,p=d();return v(p.deleteUser(a))}),o(3," Delete "),i()}if(t&2){let e=d().$implicit;F("banned",e.banned),l(),O(" ",e.banned?"Unban":"Ban"," ")}}function be(t,s){if(t&1){let e=P();n(0,"tr")(1,"td"),o(2),i(),n(3,"td")(4,"select",7),c("change",function(a){let p=x(e).$implicit,U=d();return v(U.changeRole(p,a))}),n(5,"option",8),o(6,"User"),i(),n(7,"option",9),o(8,"Admin"),i(),n(9,"option",10),o(10,"Owner"),i()()(),n(11,"td"),u(12,fe,4,1,"span",11)(13,ge,2,0,"span",12),i(),n(14,"td",13),u(15,_e,4,3),i()()}if(t&2){let e=s.$implicit;l(2),S(e.email),l(2),m("value",e.rol)("disabled",e.rol==="Owner"),l(8),_(e.banned?12:13),l(3),_(e.rol!=="Owner"?15:-1)}}var re=(()=>{class t{constructor(e){this.profileService=e,this.users=[],this.showBanDialog=!1,this.selectedUser=null}ngOnInit(){this.loadUsers()}loadUsers(){this.profileService.getUsers().subscribe(e=>{this.users=e})}openBanDialog(e){e.banned?this.unbanUser(e):(this.selectedUser=e,this.showBanDialog=!0)}closeBanDialog(){this.showBanDialog=!1,this.selectedUser=null}confirmBan(e){this.selectedUser&&(console.log("Duracion de ban desde confirm ban owner ",e.duration),this.profileService.banUser(this.selectedUser.id,e).subscribe(()=>{this.loadUsers(),this.closeBanDialog()}))}unbanUser(e){this.profileService.unbanUser(e.id).subscribe(()=>{this.loadUsers()})}changeRole(e,r){let a=r.target.value;this.profileService.changeUserRole(e.id,a).subscribe(()=>{this.loadUsers()})}deleteUser(e){confirm(`Are you sure you want to delete ${e.email}?`)&&this.profileService.deleteUser(e.id).subscribe(()=>{this.loadUsers()})}static{this.\u0275fac=function(r){return new(r||t)(g(M))}}static{this.\u0275cmp=b({type:t,selectors:[["owner-panel"]],standalone:!0,features:[h],decls:24,vars:2,consts:[[1,"owner-card"],[1,"header"],["routerLink","/park-management",1,"manage-park-button"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M3 12h18M12 3l7 9-7 9"],[1,"user-list"],[3,"close","confirm","isOpen","userEmail"],[3,"change","value","disabled"],["value","User"],["value","Admin"],["value","Owner"],[1,"banned-status"],[1,"active-status"],[1,"actions"],[3,"click"],[1,"delete",3,"click"]],template:function(r,a){r&1&&(n(0,"div",0)(1,"div",1)(2,"h2"),o(3,"Full User Management"),i(),n(4,"button",2),o(5," Manage Park Content "),E(),n(6,"svg",3),f(7,"path",4),i()()(),y(),n(8,"div",5)(9,"table")(10,"thead")(11,"tr")(12,"th"),o(13,"Email"),i(),n(14,"th"),o(15,"Role"),i(),n(16,"th"),o(17,"Status"),i(),n(18,"th"),o(19,"Actions"),i()()(),n(20,"tbody"),D(21,be,16,5,"tr",null,ce),i()()(),n(23,"ban-dialog",6),c("close",function(){return a.closeBanDialog()})("confirm",function(U){return a.confirmBan(U)}),i()()),r&2&&(l(21),B(a.users),l(2),m("isOpen",a.showBanDialog)("userEmail",(a.selectedUser==null?null:a.selectedUser.email)||""))},dependencies:[w,$,Y,A,V],styles:[".owner-card[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 4px #0000001a}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.manage-park-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:#2a623d;color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px #0000001a}.manage-park-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 6px #00000026;background:#1a472a}.manage-park-button[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 4px #0000001a}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid #eee}select[_ngcontent-%COMP%]{padding:.5rem;border-radius:4px;border:1px solid #ddd}.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;cursor:pointer}button.banned[_ngcontent-%COMP%]{background:#2ecc71;color:#fff}button[_ngcontent-%COMP%]:not(.banned):not(.manage-park-button){background:#e74c3c;color:#fff}button.delete[_ngcontent-%COMP%]{background:#c0392b;color:#fff}.banned-status[_ngcontent-%COMP%]{color:#e74c3c;font-weight:500}.active-status[_ngcontent-%COMP%]{color:#2ecc71;font-weight:500}"]})}}return t})();var he=(t,s)=>s.id;function Ce(t,s){if(t&1&&(o(0),T(1,"date")),t&2){let e=d(3).$implicit;O(" until ",I(1,1,e.banInfo==null?null:e.banInfo.bannedUntil)," ")}}function xe(t,s){t&1&&o(0," permanently ")}function ve(t,s){if(t&1&&(n(0,"span",3),o(1," Banned "),u(2,Ce,2,3)(3,xe,1,0),i()),t&2){let e=d(2).$implicit;l(2),_(e.banInfo!=null&&e.banInfo.bannedUntil?2:3)}}function we(t,s){t&1&&(n(0,"span",4),o(1,"Active"),i())}function Pe(t,s){if(t&1){let e=P();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),u(6,ve,4,1,"span",3)(7,we,2,0,"span",4),i(),n(8,"td")(9,"button",5),c("click",function(){x(e);let a=d().$implicit,p=d();return v(p.openBanDialog(a))}),o(10),i()()()}if(t&2){let e=d().$implicit;l(2),S(e.email),l(2),S(e.rol),l(2),_(e.banned?6:7),l(3),F("banned",e.banned),l(),O(" ",e.banned?"Unban":"Ban"," ")}}function Se(t,s){if(t&1&&u(0,Pe,11,6,"tr"),t&2){let e=s.$implicit;_(e.rol==="User"?0:-1)}}var ae=(()=>{class t{constructor(e){this.profileService=e,this.users=[],this.showBanDialog=!1,this.selectedUser=null}ngOnInit(){this.loadUsers()}loadUsers(){this.profileService.getUsers().subscribe(e=>{this.users=e})}openBanDialog(e){e.banned?this.unbanUser(e):(this.selectedUser=e,this.showBanDialog=!0)}closeBanDialog(){this.showBanDialog=!1,this.selectedUser=null}confirmBan(e){this.selectedUser&&this.profileService.banUser(this.selectedUser.id,e).subscribe(()=>{this.loadUsers(),this.closeBanDialog()})}unbanUser(e){this.profileService.unbanUser(e.id).subscribe(()=>{this.loadUsers()})}static{this.\u0275fac=function(r){return new(r||t)(g(M))}}static{this.\u0275cmp=b({type:t,selectors:[["admin-panel"]],standalone:!0,features:[h],decls:19,vars:2,consts:[[1,"admin-card"],[1,"user-list"],[3,"close","confirm","isOpen","userEmail"],[1,"banned-status"],[1,"active-status"],[3,"click"]],template:function(r,a){r&1&&(n(0,"div",0)(1,"h2"),o(2,"User Management"),i(),n(3,"div",1)(4,"table")(5,"thead")(6,"tr")(7,"th"),o(8,"Email"),i(),n(9,"th"),o(10,"Role"),i(),n(11,"th"),o(12,"Status"),i(),n(13,"th"),o(14,"Actions"),i()()(),n(15,"tbody"),D(16,Se,1,1,null,null,he),i()()(),n(18,"ban-dialog",2),c("close",function(){return a.closeBanDialog()})("confirm",function(U){return a.confirmBan(U)}),i()()),r&2&&(l(16),B(a.users),l(2),m("isOpen",a.showBanDialog)("userEmail",(a.selectedUser==null?null:a.selectedUser.email)||""))},dependencies:[w,$,Y],styles:[".admin-card[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 4px #0000001a}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid #eee}button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;cursor:pointer;background:#e74c3c;color:#fff}button.banned[_ngcontent-%COMP%]{background:#2ecc71}.banned-status[_ngcontent-%COMP%]{color:#e74c3c;font-weight:500}.active-status[_ngcontent-%COMP%]{color:#2ecc71;font-weight:500}"]})}}return t})();var le=(()=>{class t{constructor(e,r){this.fb=e,this.profileService=r,this.email="",this.profileForm=this.fb.group({parkName:["",[C.required,C.minLength(3)]]}),this.passwordForm=this.fb.group({currentPassword:["",[C.required]],newPassword:["",[C.required,C.minLength(6)]]}),this.loadUserProfile()}loadUserProfile(){this.profileService.getUserProfile().subscribe(e=>{this.email=e.email,this.profileForm.patchValue({parkName:e.parkName})})}onSubmit(){this.profileForm.valid&&this.profileService.updateProfile(this.profileForm.value).subscribe()}onPasswordChange(){this.passwordForm.valid&&this.profileService.changePassword(this.passwordForm.value).subscribe()}resetPark(){confirm("Are you sure you want to reset your park? This action cannot be undone.")&&this.profileService.resetPark().subscribe()}static{this.\u0275fac=function(r){return new(r||t)(g(z),g(M))}}static{this.\u0275cmp=b({type:t,selectors:[["user-profile"]],standalone:!0,features:[h],decls:33,vars:5,consts:[[1,"profile-card"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","email","disabled","",3,"value"],["type","text","formControlName","parkName"],["type","submit",3,"disabled"],[1,"password-section"],["type","password","formControlName","currentPassword"],["type","password","formControlName","newPassword"],[1,"danger-zone"],[1,"reset-button",3,"click"]],template:function(r,a){r&1&&(n(0,"div",0)(1,"h2"),o(2,"Profile Settings"),i(),n(3,"form",1),c("ngSubmit",function(){return a.onSubmit()}),n(4,"div",2)(5,"label"),o(6,"Email"),i(),f(7,"input",3),i(),n(8,"div",2)(9,"label"),o(10,"Park Name"),i(),f(11,"input",4),i(),n(12,"button",5),o(13," Save Changes "),i()(),n(14,"div",6)(15,"h3"),o(16,"Change Password"),i(),n(17,"form",1),c("ngSubmit",function(){return a.onPasswordChange()}),n(18,"div",2)(19,"label"),o(20,"Current Password"),i(),f(21,"input",7),i(),n(22,"div",2)(23,"label"),o(24,"New Password"),i(),f(25,"input",8),i(),n(26,"button",5),o(27," Update Password "),i()()(),n(28,"div",9)(29,"h3"),o(30,"Danger Zone"),i(),n(31,"button",10),c("click",function(){return a.resetPark()}),o(32," Reset Park Progress "),i()()()),r&2&&(l(3),m("formGroup",a.profileForm),l(4),m("value",a.email),l(5),m("disabled",a.profileForm.invalid),l(5),m("formGroup",a.passwordForm),l(9),m("disabled",a.passwordForm.invalid))},dependencies:[H,G,N,R,j,L,q,w],styles:[".profile-card[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 4px #0000001a}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#333}input[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #ddd;border-radius:4px}input[_ngcontent-%COMP%]:disabled{background:#f5f5f5}button[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#2a623d;color:#fff;border:none;border-radius:4px;cursor:pointer}.password-section[_ngcontent-%COMP%], .danger-zone[_ngcontent-%COMP%]{margin-top:2rem;padding-top:2rem;border-top:1px solid #eee}.reset-button[_ngcontent-%COMP%]{background:#e74c3c}"]})}}return t})();function Oe(t,s){t&1&&f(0,"admin-panel")}function Me(t,s){t&1&&f(0,"owner-panel")}var Ke=(()=>{class t{constructor(e){this.authService=e,this.userRole="User",this.authService.currentUser$.subscribe(r=>{r&&(console.log("User desde profile",r),this.userRole=r.rol)})}static{this.\u0275fac=function(r){return new(r||t)(g(ee))}}static{this.\u0275cmp=b({type:t,selectors:[["profile"]],standalone:!0,features:[h],decls:8,vars:2,consts:[[1,"profile-container"],["routerLink","/park","title","Return to Park",1,"back-button"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M19 12H5M12 19l-7-7 7-7"],[1,"profile-content"]],template:function(r,a){r&1&&(n(0,"div",0)(1,"a",1),E(),n(2,"svg",2),f(3,"path",3),i()(),y(),n(4,"div",4),f(5,"user-profile"),u(6,Oe,1,0,"admin-panel")(7,Me,1,0,"owner-panel"),i()()),r&2&&(l(6),_(a.userRole==="Admin"?6:-1),l(),_(a.userRole==="Owner"?7:-1))},dependencies:[re,ae,le,A,V],styles:[".profile-container[_ngcontent-%COMP%]{min-height:100vh;background:#f0f2f5;padding:2rem;position:relative}.profile-content[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;display:grid;gap:2rem}.back-button[_ngcontent-%COMP%]{position:fixed;top:1rem;left:1rem;display:flex;align-items:center;justify-content:center;width:40px;height:40px;background:#fff;border-radius:50%;box-shadow:0 2px 4px #0000001a;color:#2a623d;transition:transform .2s;z-index:100}.back-button[_ngcontent-%COMP%]:hover{transform:scale(1.05)}"]})}}return t})();export{Ke as ProfileComponent};
